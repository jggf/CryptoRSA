package org.example;

import javax.xml.bind.DatatypeConverter;
import java.nio.charset.StandardCharsets;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.NoSuchAlgorithmException;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;

public class Main {

    public static void main(String[] args) {
        try {
            crearLlaves();
            System.out.println("ENC MODULE AND EXPONENT : ");
            try {
                String tkEn = Encrypt.enc("818b97dccbdc6cc9baea9ccde9ed81035264b190d89844ae60dd16fec14451d27b0f3807867d6812bc2ebe1f23b53f54d021d48df8d27be6c932129c3cb9613912235ef3d7f697b2d6e8de5a30e221b1c19d927ea566b9700ba392dbdd4dca1997dd5009d0634ea0813428432bbfbb5c9e025ed8a6083971eadb7ad4a5de2d7d75f0f2199f5f4b63e5e1d5b436fea51ba32791473073b0a1428938a8305fb956e40719ed7d3a8f02e095a51a9bec37aad3655e099e99fc49067ae381e7a02db90424160712bd5d191d8c229cec939aa1878c35fc1a996d47c62791fb83ab7ab6e4fde992669b510d861342b067ddf5801dbb948779c45c3f441e2183334ba005010001".toUpperCase());

                System.out.println("Check Value : " + CheckValue.checkValue(tkEn.getBytes(StandardCharsets.UTF_8)));

                Desincrypt.des("308204BE020100300D06092A864886F70D0101010500048204A8308204A40201000282010100818B97DCCBDC6CC9BAEA9CCDE9ED81035264B190D89844AE60DD16FEC14451D27B0F3807867D6812BC2EBE1F23B53F54D021D48DF8D27BE6C932129C3CB9613912235EF3D7F697B2D6E8DE5A30E221B1C19D927EA566B9700BA392DBDD4DCA1997DD5009D0634EA0813428432BBFBB5C9E025ED8A6083971EADB7AD4A5DE2D7D75F0F2199F5F4B63E5E1D5B436FEA51BA32791473073B0A1428938A8305FB956E40719ED7D3A8F02E095A51A9BEC37AAD3655E099E99FC49067AE381E7A02DB90424160712BD5D191D8C229CEC939AA1878C35FC1A996D47C62791FB83AB7AB6E4FDE992669B510D861342B067DDF5801DBB948779C45C3F441E2183334BA0050203010001028201001C214AD5B832E2309FF5081DB2994F358073BB171FE158B0A0FA015F4A6A62761920C1E2E8725CE20C98FDD1D738294B6A729E2C4206BABEEF9B7EED0C4698F5029A49A91B914179A52F25F161C208DD079506D597670A07698F987943C1FB8BB92D668EEB00557786F6E3734A91B4C6B4CD00F97C7C36B524F189E79928F8A980A622140F3520390356AF1F77056EF264E60B497125967C0B4F8057EB2D0D36858A43A1FBD907176DFD5C00689F8F6EDD374665A0C94287A90878ECC5476A6DB85F64150B52445A26E3BB1AFF4729D3CB69F108D1B40CC1B8A808D9DA272A9B696FEF336E3375D6138054686EE59A5B25E64B41EE61375D531130BE4574018102818100D4739173F3B9D56BA4B96115C735A1EE8245CA92A6FEDAEE8B6251610AE226E5ECDF846E8629803764EB9573FDEF38FA449407FCC2DDC2A5F62A175A444C2F9F1A650E47639AB7CBBCB1ADAF9DC989D88919CB51855C491B5E2459D0DF39A731FEE83B168FDC4AE302F30655334427C04D4E9ACEC8B28EB2F257C9E2F880C9E5028181009C1982112AC0A6FCAB711F54B2946E727A7A0C82EA6F1A59B12B7A94D961495791CF1C88BE0F428F055AE8FF338335831FCE4459D45CA05F7CC013DAAD8642423AD1F6E2A5B41C1C8421B5FACF7F3AD80BDA797084FF4985C488AB7ED49089A0DA4BB5705ACDFD7C5B0A13384D30E34DF099912F15487531E6438C65A2E39BA102818100B095D29B6744DA60DB8CFE6644AB8E8A199BFAF1847EA6E8C9D011C6306EA3584F57C5D2BC0EF8B4925CC25FA3FCD806254449934D41580DEC1B3647E026D71A4EAD1A7E3A0B1AA3EC965EC06ECD5A9731F5CFAA55C7CC38443AC0B0BD2A458F67CA0D7B065E5B9C6F1222FC645D4D1128F0A1FA289549C8F16808B5704A54050281801B54F00C37732209EDAED1F08F9023C291A55B197518DD01455F3A8863838046FFF5C6A63EB9074B6981A07846B9BB9DE8ECC1D504B4EF33A8F12CC8C64752C4ABEDE58F8BB9FC8E15A89D677BFB67FF3A1C17D556C428486EC00B5F1AB2F0162502CA9310A32EB61E6EA62CDE7F27DD96BA1CCCA4AA5A32D181944C9B77C4E1028181008927764A524E71D2872402C8A136A9C6A2DD49F1039563E75E091CEF1FECD0A51C993CD5F9623F99FA29031EA4A8E10CF892AA7E4E4AF6E185F7BB3AFBB5F519E9ED90BAA803454323EC4460142FC86A2E3714D7FE417AF208E52C03FAAEDFCC67694E8F9E92040FC8692255B3C64EE7D475822389D3532233B1445155CBC02B", tkEn);
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
            System.out.println("\n\r");
            System.out.println("ENC With Public Complete : ");
            try {
                String tkEn2 = Encrypt.encPK("30820122300D06092A864886F70D01010105000382010F003082010A0282010100818B97DCCBDC6CC9BAEA9CCDE9ED81035264B190D89844AE60DD16FEC14451D27B0F3807867D6812BC2EBE1F23B53F54D021D48DF8D27BE6C932129C3CB9613912235EF3D7F697B2D6E8DE5A30E221B1C19D927EA566B9700BA392DBDD4DCA1997DD5009D0634EA0813428432BBFBB5C9E025ED8A6083971EADB7AD4A5DE2D7D75F0F2199F5F4B63E5E1D5B436FEA51BA32791473073B0A1428938A8305FB956E40719ED7D3A8F02E095A51A9BEC37AAD3655E099E99FC49067AE381E7A02DB90424160712BD5D191D8C229CEC939AA1878C35FC1A996D47C62791FB83AB7AB6E4FDE992669B510D861342B067DDF5801DBB948779C45C3F441E2183334BA0050203010001".toUpperCase());
                Desincrypt.des("308204BE020100300D06092A864886F70D0101010500048204A8308204A40201000282010100818B97DCCBDC6CC9BAEA9CCDE9ED81035264B190D89844AE60DD16FEC14451D27B0F3807867D6812BC2EBE1F23B53F54D021D48DF8D27BE6C932129C3CB9613912235EF3D7F697B2D6E8DE5A30E221B1C19D927EA566B9700BA392DBDD4DCA1997DD5009D0634EA0813428432BBFBB5C9E025ED8A6083971EADB7AD4A5DE2D7D75F0F2199F5F4B63E5E1D5B436FEA51BA32791473073B0A1428938A8305FB956E40719ED7D3A8F02E095A51A9BEC37AAD3655E099E99FC49067AE381E7A02DB90424160712BD5D191D8C229CEC939AA1878C35FC1A996D47C62791FB83AB7AB6E4FDE992669B510D861342B067DDF5801DBB948779C45C3F441E2183334BA0050203010001028201001C214AD5B832E2309FF5081DB2994F358073BB171FE158B0A0FA015F4A6A62761920C1E2E8725CE20C98FDD1D738294B6A729E2C4206BABEEF9B7EED0C4698F5029A49A91B914179A52F25F161C208DD079506D597670A07698F987943C1FB8BB92D668EEB00557786F6E3734A91B4C6B4CD00F97C7C36B524F189E79928F8A980A622140F3520390356AF1F77056EF264E60B497125967C0B4F8057EB2D0D36858A43A1FBD907176DFD5C00689F8F6EDD374665A0C94287A90878ECC5476A6DB85F64150B52445A26E3BB1AFF4729D3CB69F108D1B40CC1B8A808D9DA272A9B696FEF336E3375D6138054686EE59A5B25E64B41EE61375D531130BE4574018102818100D4739173F3B9D56BA4B96115C735A1EE8245CA92A6FEDAEE8B6251610AE226E5ECDF846E8629803764EB9573FDEF38FA449407FCC2DDC2A5F62A175A444C2F9F1A650E47639AB7CBBCB1ADAF9DC989D88919CB51855C491B5E2459D0DF39A731FEE83B168FDC4AE302F30655334427C04D4E9ACEC8B28EB2F257C9E2F880C9E5028181009C1982112AC0A6FCAB711F54B2946E727A7A0C82EA6F1A59B12B7A94D961495791CF1C88BE0F428F055AE8FF338335831FCE4459D45CA05F7CC013DAAD8642423AD1F6E2A5B41C1C8421B5FACF7F3AD80BDA797084FF4985C488AB7ED49089A0DA4BB5705ACDFD7C5B0A13384D30E34DF099912F15487531E6438C65A2E39BA102818100B095D29B6744DA60DB8CFE6644AB8E8A199BFAF1847EA6E8C9D011C6306EA3584F57C5D2BC0EF8B4925CC25FA3FCD806254449934D41580DEC1B3647E026D71A4EAD1A7E3A0B1AA3EC965EC06ECD5A9731F5CFAA55C7CC38443AC0B0BD2A458F67CA0D7B065E5B9C6F1222FC645D4D1128F0A1FA289549C8F16808B5704A54050281801B54F00C37732209EDAED1F08F9023C291A55B197518DD01455F3A8863838046FFF5C6A63EB9074B6981A07846B9BB9DE8ECC1D504B4EF33A8F12CC8C64752C4ABEDE58F8BB9FC8E15A89D677BFB67FF3A1C17D556C428486EC00B5F1AB2F0162502CA9310A32EB61E6EA62CDE7F27DD96BA1CCCA4AA5A32D181944C9B77C4E1028181008927764A524E71D2872402C8A136A9C6A2DD49F1039563E75E091CEF1FECD0A51C993CD5F9623F99FA29031EA4A8E10CF892AA7E4E4AF6E185F7BB3AFBB5F519E9ED90BAA803454323EC4460142FC86A2E3714D7FE417AF208E52C03FAAEDFCC67694E8F9E92040FC8692255B3C64EE7D475822389D3532233B1445155CBC02B",
                        tkEn2);
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public static void crearLlaves() {
        try {
            KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
            kpg.initialize(2048);
            KeyPair kp = kpg.genKeyPair();
            RSAPrivateKey privateKey = (RSAPrivateKey) kp.getPrivate();
            RSAPublicKey publicKey = (RSAPublicKey) kp.getPublic();

            byte[] privateKeyBytes = privateKey.getEncoded();

            byte[] publicKeyBytes = publicKey.getEncoded();

            // Convertir a formato hexadecimal

            // Imprimir resultados
            System.out.println("Private Key:");
            System.out.println(DatatypeConverter.printHexBinary(privateKeyBytes));


            System.out.println("Public Key:");
            System.out.println(DatatypeConverter.printHexBinary(publicKeyBytes));
            System.out.println(publicKey.getModulus().toString(16));
            System.out.println(DatatypeConverter.printHexBinary(publicKey.getPublicExponent().toByteArray()));

        } catch (NoSuchAlgorithmException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }

}